# IntelliJ IDEA MCP Server - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ å‰ç½®è¦æ±‚

### å¿…éœ€ç¯å¢ƒ
- **IntelliJ IDEA**: 2024.1 æˆ–æ›´é«˜ç‰ˆæœ¬
- **JDK**: Java 17 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Node.js**: 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **Claude Desktop**: æœ€æ–°ç‰ˆæœ¬ï¼ˆç”¨äº MCP é›†æˆï¼‰

### æ£€æŸ¥ç¯å¢ƒ

```bash
# æ£€æŸ¥ Java ç‰ˆæœ¬
java -version
# åº”è¾“å‡º: java version "17.0.x" æˆ–æ›´é«˜

# æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version
# åº”è¾“å‡º: v18.x.x æˆ–æ›´é«˜

# æ£€æŸ¥ npm ç‰ˆæœ¬
npm --version
# åº”è¾“å‡º: 9.x.x æˆ–æ›´é«˜
```

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ– Gradle Wrapper

é¡¹ç›®ç›®å‰ç¼ºå°‘ Gradle Wrapperï¼Œéœ€è¦å…ˆç”Ÿæˆï¼š

```bash
cd E:\Idea-mcp

# ä½¿ç”¨ç³»ç»Ÿå·²å®‰è£…çš„ Gradle ç”Ÿæˆ wrapper
gradle wrapper --gradle-version 8.5

# æˆ–è€…ç›´æ¥ä¸‹è½½ Gradle Wrapper æ–‡ä»¶
# Windows PowerShell:
Invoke-WebRequest -Uri https://raw.githubusercontent.com/gradle/gradle/master/gradle/wrapper/gradle-wrapper.jar -OutFile gradle\wrapper\gradle-wrapper.jar
Invoke-WebRequest -Uri https://raw.githubusercontent.com/gradle/gradle/master/gradle/wrapper/gradle-wrapper.properties -OutFile gradle\wrapper\gradle-wrapper.properties
```

---

## ğŸ”¨ ç¬¬äºŒæ­¥ï¼šç¼–è¯‘é¡¹ç›®

### 2.1 ç¼–è¯‘ IDEA Pluginï¼ˆKotlinï¼‰

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd E:\Idea-mcp

# ç¼–è¯‘æ’ä»¶
.\gradlew :idea-plugin:build

# å¦‚æœç¼–è¯‘æˆåŠŸï¼Œä¼šçœ‹åˆ°ï¼š
# BUILD SUCCESSFUL
```

### 2.2 ç¼–è¯‘ MCP Serverï¼ˆTypeScriptï¼‰

```bash
# è¿›å…¥ MCP Server ç›®å½•
cd mcp-server

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
npm install

# ç¼–è¯‘ TypeScript
npm run build

# å¦‚æœæˆåŠŸï¼Œä¼šåœ¨ dist/ ç›®å½•ç”Ÿæˆ JavaScript æ–‡ä»¶
```

---

## ğŸƒ ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œ IDEA Plugin

### æ–¹å¼1ï¼šåœ¨å¼€å‘æ²™ç®±ä¸­è¿è¡Œï¼ˆæ¨èï¼‰

```bash
cd E:\Idea-mcp

# å¯åŠ¨ IDEA æ²™ç®±ï¼ˆä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„ IDEA å®ä¾‹ï¼‰
.\gradlew runIde
```

è¿™ä¼šï¼š
1. å¯åŠ¨ä¸€ä¸ªæ–°çš„ IntelliJ IDEA å®ä¾‹
2. è‡ªåŠ¨å®‰è£… IDEA MCP Plugin
3. è‡ªåŠ¨å¯åŠ¨ HTTP Serverï¼ˆç«¯å£ 58888ï¼‰

### æ–¹å¼2ï¼šæ„å»ºæ’ä»¶ ZIP å¹¶å®‰è£…åˆ°ç°æœ‰ IDEA

```bash
# æ„å»ºæ’ä»¶å‘å¸ƒåŒ…
.\gradlew buildPlugin

# æ’ä»¶ ZIP æ–‡ä»¶ä¼šç”Ÿæˆåœ¨ï¼š
# build/distributions/idea-plugin-1.0.0.zip
```

ç„¶ååœ¨ IDEA ä¸­ï¼š
1. **Settings** â†’ **Plugins** â†’ **âš™ï¸** â†’ **Install Plugin from Disk...**
2. é€‰æ‹©ç”Ÿæˆçš„ ZIP æ–‡ä»¶
3. é‡å¯ IDEA

---

## âœ… ç¬¬å››æ­¥ï¼šéªŒè¯ IDEA Plugin æ˜¯å¦è¿è¡Œ

### 4.1 æ£€æŸ¥æ’ä»¶èœå•

åœ¨ IDEA ä¸­æ‰“å¼€ä»»æ„é¡¹ç›®ï¼Œæ£€æŸ¥èœå•æ ï¼š
- **Tools** â†’ **IDEA MCP**
- åº”è¯¥èƒ½çœ‹åˆ°ï¼š
  - Start MCP Server
  - Stop MCP Server
  - Restart MCP Server

### 4.2 æ£€æŸ¥ HTTP Server çŠ¶æ€

æ‰“å¼€æµè§ˆå™¨æˆ–ä½¿ç”¨ curlï¼š

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹
curl http://localhost:58888/api/v1/health

# é¢„æœŸå“åº”ï¼š
{
  "success": true,
  "data": {
    "status": "ok",
    "ideaVersion": "2024.1.1",
    "indexReady": true
  }
}
```

### 4.3 æµ‹è¯•ä¸€ä¸ª API ç«¯ç‚¹

```bash
# æµ‹è¯•é¡¹ç›®ç»“æ„æŸ¥è¯¢ï¼ˆä¸éœ€è¦å‚æ•°ï¼‰
curl http://localhost:58888/api/v1/project/structure

# é¢„æœŸå“åº”ï¼š
{
  "success": true,
  "data": {
    "projectName": "...",
    "projectPath": "...",
    "modules": [...]
  }
}
```

---

## ğŸ”Œ ç¬¬äº”æ­¥ï¼šé…ç½® MCP Server

### 5.1 é…ç½® Claude Desktop

ç¼–è¾‘ Claude Desktop çš„é…ç½®æ–‡ä»¶ï¼š

**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`
**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
**Linux**: `~/.config/Claude/claude_desktop_config.json`

æ·»åŠ  MCP Server é…ç½®ï¼š

```json
{
  "mcpServers": {
    "idea-mcp": {
      "command": "node",
      "args": [
        "E:\\Idea-mcp\\mcp-server\\dist\\index.js"
      ],
      "env": {
        "IDEA_MCP_BASE_URL": "http://localhost:58888"
      }
    }
  }
}
```

**æ³¨æ„**ï¼š
- å°†è·¯å¾„ `E:\\Idea-mcp` æ›¿æ¢ä¸ºä½ çš„å®é™…é¡¹ç›®è·¯å¾„
- Windows è·¯å¾„éœ€è¦ä½¿ç”¨åŒåæ–œæ  `\\` æˆ–å•æ–œæ  `/`

### 5.2 é‡å¯ Claude Desktop

é…ç½®å®Œæˆåï¼š
1. å®Œå…¨é€€å‡º Claude Desktop
2. é‡æ–°å¯åŠ¨ Claude Desktop
3. MCP Server åº”è¯¥ä¼šè‡ªåŠ¨å¯åŠ¨

### 5.3 éªŒè¯ MCP Server è¿æ¥

åœ¨ Claude Desktop ä¸­ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ï¼š
- åœ¨å¯¹è¯æ¡†åº•éƒ¨æœ‰ä¸€ä¸ª ğŸ”Œ æˆ– MCP å›¾æ ‡
- ç‚¹å‡»æŸ¥çœ‹å·²è¿æ¥çš„ MCP Server
- åº”è¯¥èƒ½çœ‹åˆ° "idea-mcp" å¹¶æ˜¾ç¤ºä¸ºå·²è¿æ¥

---

## ğŸ¯ ç¬¬å…­æ­¥ï¼šä½¿ç”¨åŠŸèƒ½

### 6.1 åœ¨ Claude Code ä¸­ä½¿ç”¨

åœ¨ Claude Desktop æˆ– Claude Code ä¸­ï¼Œä½ å¯ä»¥ï¼š

```
è¯·å¸®æˆ‘é‡å‘½åè¿™ä¸ªå˜é‡ userName ä¸º user
ï¼ˆClaude ä¼šè°ƒç”¨ refactor_rename å·¥å…·ï¼‰

è¯·æŸ¥æ‰¾è¿™ä¸ªæ–¹æ³•çš„æ‰€æœ‰ä½¿ç”¨ä½ç½®
ï¼ˆClaude ä¼šè°ƒç”¨ navigate_find_usages å·¥å…·ï¼‰

è¯·æ ¼å¼åŒ–è¿™ä¸ªæ–‡ä»¶çš„ä»£ç 
ï¼ˆClaude ä¼šè°ƒç”¨ tools_format_code å·¥å…·ï¼‰

è¯·è¿è¡Œä»£ç æ£€æŸ¥
ï¼ˆClaude ä¼šè°ƒç”¨ analyze_code å·¥å…·ï¼‰
```

### 6.2 ç›´æ¥æµ‹è¯• APIï¼ˆä½¿ç”¨ curl æˆ– Postmanï¼‰

#### ç¤ºä¾‹1ï¼šé‡å‘½åå˜é‡

```bash
curl -X POST http://localhost:58888/api/v1/refactor/rename \
  -H "Content-Type: application/json" \
  -d '{
    "filePath": "src/main/java/com/example/Main.java",
    "line": 10,
    "column": 15,
    "newName": "newVariableName",
    "searchInComments": false,
    "preview": false
  }'
```

#### ç¤ºä¾‹2ï¼šæŸ¥æ‰¾ç”¨é€”

```bash
curl -X POST http://localhost:58888/api/v1/navigation/find-usages \
  -H "Content-Type: application/json" \
  -d '{
    "filePath": "src/main/java/com/example/Main.java",
    "line": 10,
    "column": 15,
    "maxResults": 100
  }'
```

#### ç¤ºä¾‹3ï¼šæ ¼å¼åŒ–ä»£ç 

```bash
curl -X POST http://localhost:58888/api/v1/tools/format \
  -H "Content-Type: application/json" \
  -d '{
    "filePath": "src/main/java/com/example/Main.java"
  }'
```

#### ç¤ºä¾‹4ï¼šä»£ç æ£€æŸ¥

```bash
curl -X POST http://localhost:58888/api/v1/analysis/inspections \
  -H "Content-Type: application/json" \
  -d '{
    "filePath": "src/main/java/com/example/Main.java",
    "severity": "WARNING",
    "maxResults": 50
  }'
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šHTTP Server æ²¡æœ‰å¯åŠ¨

**ç—‡çŠ¶**ï¼šè®¿é—® `http://localhost:58888/api/v1/health` è¿æ¥è¢«æ‹’ç»

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ IDEA æ§åˆ¶å°æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯
2. æ‰‹åŠ¨å¯åŠ¨ï¼š**Tools** â†’ **IDEA MCP** â†’ **Start MCP Server**
3. æ£€æŸ¥ç«¯å£ 58888 æ˜¯å¦è¢«å ç”¨ï¼š
   ```bash
   netstat -ano | findstr :58888
   ```

### é—®é¢˜2ï¼šMCP Server æ— æ³•è¿æ¥åˆ° IDEA Plugin

**ç—‡çŠ¶**ï¼šMCP å·¥å…·è°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºè¿æ¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ IDEA Plugin çš„ HTTP Server æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ `claude_desktop_config.json` ä¸­çš„ `IDEA_MCP_BASE_URL`
3. æµ‹è¯• HTTP è¿æ¥ï¼š`curl http://localhost:58888/api/v1/health`

### é—®é¢˜3ï¼šClaude Desktop çœ‹ä¸åˆ° MCP Server

**ç—‡çŠ¶**ï¼šClaude Desktop æ²¡æœ‰æ˜¾ç¤º MCP è¿æ¥å›¾æ ‡

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `claude_desktop_config.json` è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼ˆJSON æ ¼å¼ï¼‰
2. æ£€æŸ¥ MCP Server è·¯å¾„æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ Claude Desktop æ—¥å¿—ï¼š
   - **Windows**: `%APPDATA%\Claude\logs`
   - **macOS**: `~/Library/Logs/Claude`

### é—®é¢˜4ï¼šæŸäº›åŠŸèƒ½è¿”å›é”™è¯¯

**ç—‡çŠ¶**ï¼šè°ƒç”¨æŸä¸ª API è¿”å› 500 é”™è¯¯æˆ–å¤±è´¥å“åº”

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ IDEA æ§åˆ¶å°çš„è¯¦ç»†é”™è¯¯æ—¥å¿—
2. ç¡®è®¤é¡¹ç›®ç´¢å¼•å·²å®Œæˆï¼ˆIDEA å³ä¸‹è§’è¿›åº¦æ¡ï¼‰
3. ç¡®è®¤æ–‡ä»¶è·¯å¾„æ˜¯é¡¹ç›®ç›¸å¯¹è·¯å¾„ï¼ˆå¦‚ `src/Main.java`ï¼‰
4. æŸ¥çœ‹ API ç«¯ç‚¹æ–‡æ¡£ç¡®è®¤å‚æ•°æ ¼å¼

---

## ğŸ“š å¯ç”¨çš„ MCP å·¥å…·

### é‡æ„å·¥å…· (10ä¸ª)
- `refactor_rename` - é‡å‘½åç¬¦å·
- `refactor_extract_method` - æå–æ–¹æ³•
- `refactor_extract_variable` - æå–å˜é‡
- `refactor_inline_variable` - å†…è”å˜é‡
- `refactor_change_signature` - ä¿®æ”¹ç­¾å
- `refactor_move` - ç§»åŠ¨ç±»/æ–¹æ³•
- `refactor_extract_interface` - æå–æ¥å£
- `refactor_extract_superclass` - æå–çˆ¶ç±»
- `refactor_encapsulate_field` - å°è£…å­—æ®µ
- `refactor_introduce_parameter_object` - å¼•å…¥å‚æ•°å¯¹è±¡

### å¯¼èˆªå·¥å…· (5ä¸ª)
- `navigate_find_usages` - æŸ¥æ‰¾ç”¨é€”
- `navigate_goto_definition` - è·³è½¬åˆ°å®šä¹‰
- `navigate_type_hierarchy` - ç±»å‹å±‚æ¬¡ç»“æ„
- `navigate_call_hierarchy` - è°ƒç”¨å±‚æ¬¡ç»“æ„
- `navigate_find_implementations` - æŸ¥æ‰¾å®ç°

### åˆ†æå·¥å…· (3ä¸ª)
- `analyze_code` - ä»£ç æ£€æŸ¥
- `analyze_dependencies` - ä¾èµ–åˆ†æ
- `analyze_dependency_cycles` - å¾ªç¯ä¾èµ–æ£€æµ‹

### è°ƒè¯•å·¥å…· (14ä¸ª)
- `debug_set_breakpoint` - è®¾ç½®æ–­ç‚¹
- `debug_list_breakpoints` - åˆ—å‡ºæ–­ç‚¹
- `debug_remove_breakpoint` - åˆ é™¤æ–­ç‚¹
- `debug_start_session` - å¯åŠ¨è°ƒè¯•
- `debug_stop_session` - åœæ­¢è°ƒè¯•
- `debug_pause_session` - æš‚åœè°ƒè¯•
- `debug_resume_session` - æ¢å¤è°ƒè¯•
- `debug_step_over` - å•æ­¥è·¨è¿‡
- `debug_step_into` - å•æ­¥è¿›å…¥
- `debug_step_out` - å•æ­¥è·³å‡º
- `debug_evaluate_expression` - æ±‚å€¼è¡¨è¾¾å¼
- `debug_get_variables` - è·å–å˜é‡
- `debug_get_variable` - è·å–å•ä¸ªå˜é‡
- `debug_get_call_stack` - è·å–è°ƒç”¨æ ˆ

### ä»£ç ç”Ÿæˆå·¥å…· (6ä¸ª)
- `codegen_generate_getters_setters` - ç”Ÿæˆ Getter/Setter
- `codegen_generate_constructor` - ç”Ÿæˆæ„é€ å‡½æ•°
- `codegen_generate_tostring` - ç”Ÿæˆ toString
- `codegen_generate_equals` - ç”Ÿæˆ equals
- `codegen_generate_hashcode` - ç”Ÿæˆ hashCode
- `codegen_override_method` - é‡å†™æ–¹æ³•

### æœç´¢å·¥å…· (3ä¸ª)
- `search_global` - å…¨å±€æœç´¢
- `search_text` - æ–‡æœ¬æœç´¢
- `search_structural` - ç»“æ„åŒ–æœç´¢

### ä¾èµ–å·¥å…· (2ä¸ª)
- `analyze_dependencies` - åˆ†æä¾èµ–
- `analyze_dependency_cycles` - æ£€æµ‹å¾ªç¯ä¾èµ–

### VCS å·¥å…· (4ä¸ª)
- `vcs_get_status` - VCS çŠ¶æ€
- `vcs_get_history` - æ–‡ä»¶å†å²
- `vcs_get_diff` - å·®å¼‚å¯¹æ¯”
- `vcs_blame` - Blame æ³¨è§£

### é¡¹ç›®ç®¡ç†å·¥å…· (4ä¸ª)
- `project_get_structure` - é¡¹ç›®ç»“æ„
- `project_get_modules` - æ¨¡å—åˆ—è¡¨
- `project_get_libraries` - ä¾èµ–åº“
- `project_get_build_config` - æ„å»ºé…ç½®

### å®ç”¨å·¥å…· (4ä¸ª)
- `tools_format_code` - æ ¼å¼åŒ–ä»£ç 
- `tools_optimize_imports` - ä¼˜åŒ–å¯¼å…¥
- `tools_apply_quick_fix` - åº”ç”¨å¿«é€Ÿä¿®å¤
- `tools_apply_intention` - åº”ç”¨ Intention

**æ€»è®¡**: 55 ä¸ª MCP å·¥å…·

---

## ğŸ“– æ›´å¤šæ–‡æ¡£

- **API ç«¯ç‚¹æ¸…å•**: æŸ¥çœ‹ `docs/APIç«¯ç‚¹æ¸…å•.md`
- **æ¶æ„æ–‡æ¡£**: æŸ¥çœ‹ `docs/æ¶æ„æ–‡æ¡£.md`
- **éœ€æ±‚æ–‡æ¡£**: æŸ¥çœ‹ `docs/éœ€æ±‚æ–‡æ¡£.md`
- **stdio é€šä¿¡ç¤ºä¾‹**: æŸ¥çœ‹ `docs/stdioé€šä¿¡ç¤ºä¾‹.md`

---

## ğŸ‰ å¼€å§‹ä½¿ç”¨ï¼

ç°åœ¨ä½ å¯ä»¥ï¼š
1. åœ¨ IDEA ä¸­æ‰“å¼€ä¸€ä¸ªé¡¹ç›®
2. ä½¿ç”¨ Claude Code è¿›è¡Œ AI è¾…åŠ©ç¼–ç¨‹
3. Claude ä¼šè‡ªåŠ¨è°ƒç”¨ IDEA çš„å¼ºå¤§é‡æ„å’Œåˆ†æåŠŸèƒ½
4. äº«å—ç²¾ç¡®çš„ä»£ç é‡æ„å’Œæ™ºèƒ½å¯¼èˆªï¼

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€
